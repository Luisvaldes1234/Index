<!DOCTYPE html>
<html lang="es" class="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Reportes - TrackMyVend</title>
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Supabase JS -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.8.0/dist/umd/supabase.min.js"></script>
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200 min-h-screen">

  <!-- HEADER -->
  <header class="bg-white dark:bg-gray-800 p-4 shadow flex justify-between items-center">
    <h1 class="text-xl font-bold">Reportes</h1>
    <button id="btnLogout" class="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded">
      Cerrar sesión
    </button>
  </header>

  <!-- FILTROS -->
  <section class="p-4 bg-white dark:bg-gray-800 shadow mt-4 mx-4 rounded flex flex-wrap gap-4 items-end">
    <div>
      <label for="fechaDesde" class="block text-sm">Desde</label>
      <input type="date" id="fechaDesde" class="mt-1 p-2 border rounded w-full bg-gray-50 dark:bg-gray-700" />
    </div>
    <div>
      <label for="fechaHasta" class="block text-sm">Hasta</label>
      <input type="date" id="fechaHasta" class="mt-1 p-2 border rounded w-full bg-gray-50 dark:bg-gray-700" />
    </div>
    <div>
      <label for="filtroMaquina" class="block text-sm">Máquina</label>
      <select id="filtroMaquina" class="mt-1 p-2 border rounded w-full bg-gray-50 dark:bg-gray-700">
        <option value="">Todas las máquinas</option>
      </select>
    </div>
    <button id="btnAplicarFiltros" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded">
      Aplicar filtros
    </button>
  </section>

  <!-- LOADING SPINNER -->
  <div id="loading" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center">
    <div class="loader ease-linear rounded-full border-8 border-t-8 border-gray-200 h-16 w-16"></div>
  </div>

  <!-- LISTA DE REPORTES -->
  <main id="reportesContainer" class="p-4 mx-4 mt-4 bg-white dark:bg-gray-800 shadow rounded grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
    <button class="tab bg-blue-100 dark:bg-blue-900 p-4 rounded hover:bg-blue-200" data-tab="ventasDetallado" onclick="mostrarReporte('ventasDetallado')">
      Ventas detallado
    </button>
    <button class="tab bg-blue-100 dark:bg-blue-900 p-4 rounded hover:bg-blue-200" data-tab="rendimientoMaquina" onclick="mostrarReporte('rendimientoMaquina')">
      Rendimiento por máquina
    </button>
    <button class="tab bg-blue-100 dark:bg-blue-900 p-4 rounded hover:bg-blue-200" data-tab="analisisHorarios" onclick="mostrarReporte('analisisHorarios')">
      Análisis de horarios
    </button>
    <button class="tab bg-blue-100 dark:bg-blue-900 p-4 rounded hover:bg-blue-200" data-tab="corteCaja" onclick="mostrarReporte('corteCaja')">
      Corte de caja
    </button>
    <button class="tab bg-blue-100 dark:bg-blue-900 p-4 rounded hover:bg-blue-200" data-tab="ticketPromedio" onclick="mostrarReporte('ticketPromedio')">
      Ticket promedio
    </button>
    <button class="tab bg-blue-100 dark:bg-blue-900 p-4 rounded hover:bg-blue-200" data-tab="proyecciones" onclick="mostrarReporte('proyecciones')">
      Proyecciones
    </button>
    <button class="tab bg-blue-100 dark:bg-blue-900 p-4 rounded hover:bg-blue-200" data-tab="conectividad" onclick="mostrarReporte('conectividad')">
      Conectividad
    </button>
    <button class="tab bg-blue-100 dark:bg-blue-900 p-4 rounded hover:bg-blue-200" data-tab="mantenimientoPredictivo" onclick="mostrarReporte('mantenimientoPredictivo')">
      Mantenimiento predictivo
    </button>
    <button class="tab bg-blue-100 dark:bg-blue-900 p-4 rounded hover:bg-blue-200" data-tab="demandaVolumen" onclick="mostrarReporte('demandaVolumen')">
      Demanda por volumen
    </button>
    <button class="tab bg-blue-100 dark:bg-blue-900 p-4 rounded hover:bg-blue-200" data-tab="eficienciaOperativa" onclick="mostrarReporte('eficienciaOperativa')">
      Eficiencia operativa
    </button>
    <button class="tab bg-blue-100 dark:bg-blue-900 p-4 rounded hover:bg-blue-200" data-tab="dashboardEjecutivo" onclick="mostrarReporte('dashboardEjecutivo')">
      Dashboard ejecutivo
    </button>
  </main>

  <!-- VISTA DETALLADA -->
  <section id="reporteDetallado" class="hidden p-4 mx-4 mt-4 bg-white dark:bg-gray-800 shadow rounded">
    <button onclick="volverALista()" class="mb-4 bg-gray-300 dark:bg-gray-700 hover:bg-gray-400 px-3 py-1 rounded">
      ← Volver a lista
    </button>
    <div id="contenidoReporte"></div>
  </section>

  <!-- MODAL DE EXPORTACIÓN -->
  <div id="modalExportar" class="hidden fixed inset-0 items-center justify-center bg-black bg-opacity-50">
    <div class="bg-white dark:bg-gray-800 p-6 rounded shadow-lg w-80 mx-auto">
      <h2 class="text-lg font-bold mb-4">Exportar reporte</h2>
      <div class="flex flex-col gap-2">
        <button onclick="exportarReporte('csv')" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded">
          CSV
        </button>
        <button onclick="exportarReporte('excel')" class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded">
          Excel
        </button>
        <button onclick="exportarReporte('pdf')" class="px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded">
          PDF
        </button>
      </div>
      <button onclick="cerrarModalExportar()" class="mt-4 text-sm text-gray-500 hover:underline">
        Cancelar
      </button>
    </div>
  </div>

  <!-- TU SCRIPT DE REPORTES -->
  <script src="reportes.js"></script>
</body>
</html>
